jQuery(function(){var $doc=jQuery(document),init_widget=function(ev,el){var $widget=jQuery(el).closest(".widget"),$btn=$widget.find(".csb-visibility-button"),$target=$widget.find(".widget-control-actions .widget-control-save"),$spinner=$widget.find(".widget-control-actions .spinner");1!=$widget.data("_csb_visibility")&&($spinner.insertBefore($target).css({"float":"left"}),$btn.insertBefore($target).click(toggle_section),$widget.on("click",".toggle-action b",toggle_action),$widget.on("csb:update",update_display),$widget.on("click",".clear-filter",remove_filter),$widget.on("click",".choose-filters",show_filter_menu),$widget.on("click",".add-filter",add_filter),$widget.on("change","input[data-lbl-all][data-lbl-single]",toggle_label),$widget.on("change","select.posttype",update_posttypes),$widget.data("_csb_visibility",!0))},remove_filter=function(ev){var $me=jQuery(this),$row=$me.closest(".csb-option-row"),$widget=$me.closest(".widget"),sel="."+jQuery.trim($row.attr("class").replace("csb-option-row","")),$add_item=$widget.find('[data-for="'+sel+'"]'),$input=$row.find("input, select, textarea");return ev.preventDefault(),$add_item.show(),$row.fadeOut(400,function(){$input.val("").trigger("change.select2"),$widget.trigger("csb:update")}),!1},add_filter=function(ev){var $me=jQuery(this),sel=$me.data("for"),$widget=$me.closest(".widget"),$always=$widget.find(".csb-always"),$filter=$widget.find(sel);return ev.preventDefault(),$filter.show(),$me.hide(),$always.hide(),hide_filter_menu(),$widget.trigger("csb:update"),!1},update_display=function(){var $widget=jQuery(this).closest(".widget"),$always=$widget.find(".csb-always"),$rows=$widget.find(".csb-option-row:visible:not(.csb-action,.csb-always)");0==$rows.length?$always.show():($always.hide(),$rows.find(".csb-and").show(),$rows.first().find(".csb-and").hide()),wpmUi.upgrade_multiselect($widget)},show_filter_menu=function(ev){var $me=jQuery(this),$row=$me.closest(".csb-option-row"),$menu=$row.find(".dropdown");return ev.preventDefault(),$menu.show(),$doc.one("click",hide_filter_menu),!1},hide_filter_menu=function(){jQuery(".csb-action .dropdown:visible").hide()},toggle_section=function(ev){var $me=jQuery(this),$widget=$me.closest(".widget"),$section=$widget.find(".csb-visibility-inner"),$flag=$section.find(".csb-visible-flag");return ev.preventDefault(),"0"==$flag.val()?($flag.val(1),$section.show(),$widget.trigger("csb:update")):($flag.val(0),$section.hide()),!1},toggle_action=function(ev){var $me=jQuery(this).closest("label"),$widget=$me.closest(".widget"),sel="#"+$me.attr("for"),$action=$widget.find(sel),state=$action.val(),$lbl_show=$widget.find(".lbl-show-if"),$lbl_hide=$widget.find(".lbl-hide-if");return ev.preventDefault(),"show"!=state?($lbl_show.show(),$lbl_hide.hide(),$action.val("show")):($lbl_show.hide(),$lbl_hide.show(),$action.val("hide")),!1},toggle_label=function(){var $me=jQuery(this).closest("label"),$row=$me.closest(".csb-detail-row"),$inp=$me.find("input[type=checkbox]"),$lbl=$me.find(".lbl"),$detail=$row.find(".detail"),$detail_inp=$detail.find("input,select,textarea");$inp.prop("checked")?($lbl.text($inp.data("lbl-single")),$detail.show()):($lbl.text($inp.data("lbl-all")),$detail.hide(),$detail_inp.val("").trigger("change.select2"))},update_posttypes=function(){var i,$me=jQuery(this),$row=$me.closest(".csb-option-row"),$types=$row.find(".csb-detail-row"),types=$me.val();if($types.addClass("csb-hide"),types)for(i=0;i<types.length;i+=1)$types.filter(".csb-pt-"+types[i]).removeClass("csb-hide ");$types.each(function(){var $detail=jQuery(this),$check=$detail.find("input[type=checkbox]");$detail.hasClass("csb-hide")?($detail.hide(),$check.prop("checked",!1),toggle_label.call($check)):$detail.show()})};jQuery("#widgets-right .widget").each(init_widget),$doc.on("widget-added",init_widget)});
//# sourceMappingURL=cs-visibility.min.js.map